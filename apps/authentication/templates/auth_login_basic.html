{% extends layout_path %}

{% load static %}
{% load i18n %}

{% block title %}{% trans "Login"%} - GC PHARMA{% endblock %}

{% block page_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static  'vendor/css/pages/page-auth.css' %}">
<style>
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }

  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid #f3f3f3;
    border-top: 5px solid #696cff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
{% endblock page_css %}

{% load crispy_forms_tags %}

{% block content %}
<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner"></div>
</div>

<div class="container-xxl">
  <div class="authentication-wrapper authentication-basic container-p-y">
    <div class="authentication-inner">
      <!-- Login -->
      <div class="card px-sm-6 px-0">
        <div class="card-body">
          <!-- Logo -->
          <div class="app-brand justify-content-center">
            <a href="{% url 'index' %}" class="app-brand-link gap-2">
              <span class="app-brand-logo demo">{% include 'partials/logo.html' with withbg="#696cff" %}</span>
              <span class="app-brand-text demo text-heading fw-bold">PMS GC</span>
            </a>
          </div>
          <!-- /Logo -->
          <h4 class="mb-1">{% trans "Welcome to"%} PMS GC!</h4>
          <p class="mb-6">{% trans "Please sign-in to your account."%}</p>

          <form id="formAuthentication" class="mb-6" method="POST" onsubmit="showLoading()">
            {% csrf_token %}
            {{form|crispy}}
            <div class="mb-6">
              <button class="btn btn-primary d-grid w-100" type="submit">
              <i class="fa-solid fa-arrow-right-to-bracket"></i>
              {% trans "Login"%}</button>
            </div>
          </form>
          <p class="text-center mb-5">
            <a href="{% url 'password_reset' %}">
              <span>Forgot Password?</span>
            </a>
          </p>
        </div>
      </div>
      <!-- /Login -->
    </div>
  </div>
</div>
{% endblock %}

{% block page_js %}
<script>
  function showLoading() {
    document.getElementById('loadingOverlay').style.display = 'flex';
  }

  // Hide loading if there are any errors
  document.addEventListener('DOMContentLoaded', function() {
    const errorElements = document.querySelectorAll('.invalid-feedback');
    if (errorElements.length > 0) {
      document.getElementById('loadingOverlay').style.display = 'none';
    }
  });
</script>
{% endblock %}
